<% title "Sell a Card"%>
<h1>Sell a Card</h1>

<%= simple_form_for @listing, :url => create_generic_mtg_listings_path, :method => :post, :html => {:multipart => true} do |f| %>
  <div class="inputs">
    <br class="spacer"/>  

    <div id="New_Generic_Name_Block">                      
      <%= f.input :name,          :label => "Card Name",
                                  :input_html => { :class => "ui-autocomplete-input" , :placeholder => "Name..." , "data-autocomplete" => autocomplete_name_mtg_cards_path },
                                  :required => true %>
    </div>
    <% if not (params[:mtg_listing] && params[:mtg_listing][:set].present?) %>
      <div id="New_Generic_Set_Block" style="display:none;">        
        <%= f.input :set,           :label => "Set",
                                    :as => :select,                                  
                                    :required => true,
                                    :input_html => {:class => "chzn-select", "data-placeholder" => "Select a set..." } %>
      </div>
    <% else %>
      <div id="New_Generic_Set_Block">        
        <%= f.input :set,           :label => "Set",
                                    :as => :select,                                  
                                    :required => true,
                                    :collection => @sets.collect(&:name).zip(@sets.collect(&:code)),
                                    :input_html => {:class => "chzn-select", "data-placeholder" => "Select a set..." } %>
      </div>    
    <% end %>
    <div id="New_Generic_Info_Block" <%= "style=\'display:none;\'" if not params[:mtg_listing].present? %>>                      
      <%= f.input :condition,     :label => "Condition",
                                  :as => :select,
                                  :collection => condition_list,
                                  :default => "NM",
                                  :input_html => { :class => "chzn-select chzn-nosearch" },
                                  :required => 'true' %>

      <%= f.input :quantity,      :label => "Quantity for sale",
                                  :as => :string,
                                  :input_html => { :style => "width:50px;" },
                                  :required => 'true' %>                                

      <%= f.input :price_options, :label => "Asking Price",
                                  :as => :select,
                                  :collection =>  params[:mtg_listing].present? ? [["Low (#{number_to_currency @card.statistics.price_low.dollars})", @card.statistics.price_low.dollars],
                                                  ["Average (#{number_to_currency @card.statistics.price_med.dollars})", @card.statistics.price_med.dollars], 
                                                  ["High (#{number_to_currency @card.statistics.price_high.dollars})", @card.statistics.price_high.dollars], 
                                                  ["Other", "other"]] : [],
                                  :input_html => { :class => "chzn-select chzn-nosearch" },                                  
                                  :required => 'true' %>

      <div id="Custom_Pricing_Block" <%= "style=\'display:none;\'" unless (params[:mtg_listing] && params[:mtg_listing][:price_options] == "other") %>> 
        <%= f.input :price,         :label => "Custom Pricing",
                                    :as => :string,
                                    :input_html => {:class => "currency_input", :maxlength => 9, :value => params[:mtg_listing].present? ? params[:mtg_listing][:price] : "$ 1.00"},
                                    :required => true %>                                  
      </div>

      <%= f.input :language,      :label => "Language",
                                  :as => :select,
                                  :collection => language_list,
                                  :default => "EN",
                                  :input_html => { :class => "chzn-select chzn-nosearch" },
                                  :required => false %>    

      <%= f.input :scan,     		  :label => "Upload Scan",
                                  :as => :file %>

      <%= f.input :description,   :label => "Description",
                                  :hint => "Optional",
                                  :as => :string %>

      <%= f.label "Options" %>

      <%= f.input :foil,          :label => "Foil stamped",
                                  :default => false %>                                     

      <%= f.input :signed,        :label => "Signed by the artist",
                                  :default => false %> 

      <%= f.input :misprint,      :label => "Misprinted",
                                  :default => false %>

      <%= f.input :altart,        :label => "Contains alternate art",
                                  :default => false %>    

      
      <br class="spacer"/>
      <br class="spacer"/>  
        <%= f.button :submit, "Create Listing", :class => "center" %>
      <br class="spacer"/>
      <br class="spacer"/>      
    </div>
  </div>



<% end %>
